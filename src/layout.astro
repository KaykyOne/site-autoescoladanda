---
import "./global.css";
const title =
    Astro.props.title ||
    "Autoescola Danda | Aparecida do Taboado - MS | CNH Categoria A e B";
const description =
    Astro.props.description ||
    "Autoescola Danda em Aparecida do Taboado - MS. Mais de 10 anos formando motoristas na região. CNH categorias A e B, renovação e reciclagem. Preço justo e alta taxa de aprovação. Ligue: (67) 98136-8080";

// Gera canonical e og:url dinâmicos baseado na URL atual
const currentUrl = new URL(Astro.request.url).pathname;
const canonicalUrl = `https://autoescoladanda.com.br${currentUrl === "/" ? "" : currentUrl}`;

import Header from "./components/header.astro";
import Rodape from "./components/Rodape.astro";
import Load from "./components/load";
---

<html lang="pt-BR">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/png" href={"favicon.png"} />
        <link rel="canonical" href={canonicalUrl} />
        <meta name="generator" content={Astro.generator} />
        <meta name="description" content={description} />
        <meta
            name="keywords"
            content="autoescola Aparecida do Taboado, autoescola Mato Grosso do Sul, CNH Aparecida do Taboado, habilitação Aparecida do Taboado, carta de motorista MS, aulas de direção Aparecida do Taboado, categoria A Aparecida do Taboado, categoria B Aparecida do Taboado, moto, carro, autoescola MS, reciclagem CNH, renovação CNH, primeira habilitação Aparecida do Taboado"
        />
        <meta name="author" content="Autoescola Danda" />
        <meta name="robots" content="index, follow" />

        <!-- Geo Tags para SEO Local -->
        <meta name="geo.region" content="BR-MS" />
        <meta name="geo.placename" content="Aparecida do Taboado" />
        <meta name="geo.position" content="-20.0873;-51.0956" />
        <meta name="ICBM" content="-20.0873, -51.0956" />

        <!-- Open Graph -->
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:type" content="website" />
        <meta property="og:locale" content="pt_BR" />
        <meta property="og:url" content={canonicalUrl} />
        <meta
            property="og:site_name"
            content="Autoescola Danda - Aparecida do Taboado MS"
        />
        <meta
            property="og:image"
            content="https://autoescoladanda.com.br/og-image.png"
        />
        <meta property="og:image:width" content="1200" />
        <meta property="og:image:height" content="630" />

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta
            name="twitter:image"
            content="https://autoescoladanda.com.br/og-image.png"
        />

        <title>{title}</title>

        <!-- Schema.org - LocalBusiness Structured Data -->
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "DrivingSchool",
                "name": "Autoescola Danda",
                "image": "https://autoescoladanda.com.br/favicon.png",
                "@id": "https://autoescoladanda.com.br",
                "url": "https://autoescoladanda.com.br",
                "telephone": "+55-67-98136-8080",
                "email": "autoescoladanda@gmail.com",
                "priceRange": "$$",
                "address": {
                    "@type": "PostalAddress",
                    "streetAddress": "Rua Mariana Alves de Lima, 855",
                    "addressLocality": "Aparecida do Taboado",
                    "addressRegion": "MS",
                    "postalCode": "79570-000",
                    "addressCountry": "BR"
                },
                "geo": {
                    "@type": "GeoCoordinates",
                    "latitude": -20.0873,
                    "longitude": -51.0956
                },
                "openingHoursSpecification": [
                    {
                        "@type": "OpeningHoursSpecification",
                        "dayOfWeek": [
                            "Monday",
                            "Tuesday",
                            "Wednesday",
                            "Thursday",
                            "Friday"
                        ],
                        "opens": "08:00",
                        "closes": "18:00"
                    },
                    {
                        "@type": "OpeningHoursSpecification",
                        "dayOfWeek": "Saturday",
                        "opens": "08:00",
                        "closes": "12:00"
                    }
                ],
                "sameAs": [
                    "https://www.instagram.com/autoescoladanda/",
                    "https://wa.me/5567981368080"
                ],
                "areaServed": {
                    "@type": "City",
                    "name": "Aparecida do Taboado",
                    "containedInPlace": {
                        "@type": "State",
                        "name": "Mato Grosso do Sul"
                    }
                },
                "description": "Autoescola em Aparecida do Taboado - MS com mais de 20 anos de experiência. Oferecemos cursos para CNH categorias A e B e reciclagem. Alta taxa de aprovação e preços acessíveis."
            }
        </script>

        <!-- Google Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
            rel="stylesheet"
        />
        <link
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,1,0"
            rel="stylesheet"
        />

        <style>
            body {
                font-family: "Inter", sans-serif;
            }
        </style>
    </head>
    <body class="flex flex-col items-center overflow-x-hidden bg-neutral-900">
        <Load client:load/>
        <div class="flex flex-col w-full bg-white min-h-screen">
            <Header />
            <slot />
            <Rodape />
            <a
                href="https://wa.me/5567981368080"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Falar conosco pelo WhatsApp"
                class="bg-green-500 p-2.5 sm:p-3 cursor-pointer rounded-full hover:shadow-2xl transition-shadow duration-200 fixed right-3 sm:right-5 bottom-3 sm:bottom-5 z-[100] w-12 h-12 sm:w-14 sm:h-14 flex items-center justify-center"
            >
                <img
                    src="/icone-whatsapp.png"
                    alt="Ícone do WhatsApp"
                    height="40"
                    width="50"
                />
            </a>
        </div>
    </body>
    <script>
        window.addEventListener("load", () => {
            console.log("Tudo pronto, até o que você nem precisava");
        });

        // Intersection Observer otimizado para dispositivos mobile
        // Verifica se o dispositivo tem recursos limitados
        const isLowEndDevice = navigator.hardwareConcurrency && navigator.hardwareConcurrency < 4;

        // Configurações mais leves para dispositivos menos potentes
        const observerOptions = {
            threshold: isLowEndDevice ? 0.05 : 0.1,
            rootMargin: isLowEndDevice ? "0px" : "0px 0px -50px 0px"
        };

        // Usar requestIdleCallback para melhor performance
        const scheduleAnimation = (callback: any) => {
            if ('requestIdleCallback' in window) {
                requestIdleCallback(callback, { timeout: 100 });
            } else {
                setTimeout(callback, 0);
            }
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    scheduleAnimation(() => {
                        entry.target.classList.add("visible");
                    });
                    // Parar de observar para economizar recursos
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        // Observar apenas se as animações estiverem habilitadas
        if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            const animatedElements = document.querySelectorAll(
                ".scroll-animate, .scroll-animate-left, .scroll-animate-right, .scroll-animate-scale"
            );
            animatedElements.forEach((el) => observer.observe(el));
        } else {
            // Se o usuário prefere menos movimento, mostrar tudo imediatamente
            document.querySelectorAll(
                ".scroll-animate, .scroll-animate-left, .scroll-animate-right, .scroll-animate-scale"
            ).forEach((el) => el.classList.add("visible"));
        }
    </script>
</html>
